{"version":3,"file":null,"sources":["../src/D3Tip.js"],"sourcesContent":["const { isFunc, isNumeric, isObject, isArray } = monte.tools;\n\nconst TIP_DEFAULTS = {\n  eventPrefix: 'd3tip',\n  css: 'd3-tip',\n  direction: 'n',\n  offset: {},\n  html: (d, i) => d.value || d || i,\n  featurePrefix: '',\n  featureShowBindings: ['mouseover', 'touchstart'],\n  featureHideBindings: ['mouseout'],\n  showBindings: [],\n  hideBindings: [],\n};\n\nexport class D3Tip extends monte.Extension {\n  _initOptions(...options) {\n    super._initOptions(...options, TIP_DEFAULTS);\n\n    // Throw option error if `featurePrefix` is left blank\n    if (!this.opts.featurePrefix) {\n      throw monte.MonteOptionError.RequiredOption('featurePrefix', 'If you wish to listen directly to chart events use: \"chart\"');\n    }\n  }\n\n  _render() {\n    const css = this.tryInvoke(this.option('css'));\n    const dir = this.tryInvoke(this.option('direction'));\n    const html = this.option('html'); // Should always be a function.\n    const offset = this.tryInvoke(this.option('offset'));\n    const tip = d3.tip().attr('class', css)\n      .direction(dir)\n      .html(html);\n\n    if (!isFunc(html)) {\n      throw new monte.MonteOptionError(`Check the \"html\" option value. A function is expected. Received: ${html}`);\n    }\n\n    if (isObject(offset)) {\n      tip.offset([\n        +offset.y || +offset.top || 0,\n        +offset.x || +offset.left || 0,\n      ]);\n    }\n    else if (isNumeric(offset)) {\n      // If a single number is provided assume that only a vertical shift is intended.\n      tip.offset([+offset, 0]);\n    }\n    else {\n      throw new monte.MonteOptionError(`Check the \"offset\" option value. A function, object, or number is expected. Received: ${offset}`);\n    }\n\n    // Create D3 Tip instance and associate with chart.\n    this.chart.bound.call(tip);\n\n    this.tip = tip;\n    this._bindTipEvents();\n  }\n\n  _bindTipEvents() {\n    const tip = this.tip;\n    const featureShowBindings = this.tryInvoke(this.option('featureShowBindings'));\n    const featureHideBindings = this.tryInvoke(this.option('featureHideBindings'));\n    const showBindings = this.tryInvoke(this.option('showBindings'));\n    const hideBindings = this.tryInvoke(this.option('hideBindings'));\n\n    let featurePrefix = this.tryInvoke(this.option('featurePrefix'));\n    if (!isArray(featurePrefix)) { featurePrefix = [featurePrefix]; }\n\n    featurePrefix.forEach((fp) => {\n      featureShowBindings.forEach((ev) => this.chart.on(eventName(fp, ev), tip.show));\n      featureHideBindings.forEach((ev) => this.chart.on(eventName(fp, ev), tip.hide));\n    });\n\n    showBindings.forEach((ev) => this.chart.on(ev, tip.show));\n    hideBindings.forEach((ev) => this.chart.on(ev, tip.hide));\n  }\n\n  // Implemented to indicate that this extension intentionally does not respond to `updated` events.\n  // D3 Tip handles it's own show and hide events and renders itself.\n  _update() {}\n\n  _destroy() {\n    this.tip.destroy();\n  }\n\n  showTip(data, target) {\n    this.tip.show(data, target);\n  }\n\n  hideTip() {\n    this.tip.hide();\n  }\n}\n\nfunction eventName(featurePrefix, ev) {\n  return monte.Extension.featureEventName(featurePrefix, ev);\n}\n"],"names":["eventName","featurePrefix","ev","monte","Extension","featureEventName","tools","isFunc","isNumeric","isObject","isArray","TIP_DEFAULTS","d","i","value","D3Tip","options","this","opts","MonteOptionError","RequiredOption","css","tryInvoke","option","dir","html","offset","tip","d3","attr","direction","y","top","x","left","chart","bound","call","_bindTipEvents","featureShowBindings","featureHideBindings","showBindings","hideBindings","forEach","fp","_this2","on","show","hide","destroy","data","target"],"mappings":"gNA+FA,SAASA,GAAUC,EAAeC,SACzBC,OAAMC,UAAUC,iBAAiBJ,EAAeC,qjCAhGRC,MAAMG,MAA/CC,IAAAA,OAAQC,IAAAA,UAAWC,IAAAA,SAAUC,IAAAA,QAE/BC,eACS,YACR,mBACM,mBAEL,SAACC,EAAGC,SAAMD,GAAEE,OAASF,GAAKC,iBACjB,wBACO,YAAa,mCACb,6CAKXE,uMACKC,4JACQA,GAASL,MAG1BM,KAAKC,KAAKjB,mBACPE,OAAMgB,iBAAiBC,eAAe,gBAAiB,oGAKzDC,GAAMJ,KAAKK,UAAUL,KAAKM,OAAO,QACjCC,EAAMP,KAAKK,UAAUL,KAAKM,OAAO,cACjCE,EAAOR,KAAKM,OAAO,QACnBG,EAAST,KAAKK,UAAUL,KAAKM,OAAO,WACpCI,EAAMC,GAAGD,MAAME,KAAK,QAASR,GAChCS,UAAUN,GACVC,KAAKA,OAEHlB,EAAOkB,QACJ,IAAItB,OAAMgB,qFAAqFM,MAGnGhB,EAASiB,KACPA,SACDA,EAAOK,IAAML,EAAOM,KAAO,GAC3BN,EAAOO,IAAMP,EAAOQ,MAAQ,QAG5B,CAAA,IAAI1B,EAAUkB,QAKX,IAAIvB,OAAMgB,0GAA0GO,KAHtHA,SAASA,EAAQ,SAOlBS,MAAMC,MAAMC,KAAKV,QAEjBA,IAAMA,OACNW,qEAICX,EAAMV,KAAKU,IACXY,EAAsBtB,KAAKK,UAAUL,KAAKM,OAAO,wBACjDiB,EAAsBvB,KAAKK,UAAUL,KAAKM,OAAO,wBACjDkB,EAAexB,KAAKK,UAAUL,KAAKM,OAAO,iBAC1CmB,EAAezB,KAAKK,UAAUL,KAAKM,OAAO,iBAE5CtB,EAAgBgB,KAAKK,UAAUL,KAAKM,OAAO,iBAC1Cb,GAAQT,QAAmCA,MAElC0C,QAAQ,SAACC,KACDD,QAAQ,SAACzC,SAAO2C,GAAKV,MAAMW,GAAG9C,EAAU4C,EAAI1C,GAAKyB,EAAIoB,UACrDJ,QAAQ,SAACzC,SAAO2C,GAAKV,MAAMW,GAAG9C,EAAU4C,EAAI1C,GAAKyB,EAAIqB,YAG9DL,QAAQ,SAACzC,SAAO2C,GAAKV,MAAMW,GAAG5C,EAAIyB,EAAIoB,UACtCJ,QAAQ,SAACzC,SAAO2C,GAAKV,MAAMW,GAAG5C,EAAIyB,EAAIqB,mFAQ9CrB,IAAIsB,0CAGHC,EAAMC,QACPxB,IAAIoB,KAAKG,EAAMC,0CAIfxB,IAAIqB,cA5Ec7C,MAAMC"}