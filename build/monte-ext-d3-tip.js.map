{"version":3,"file":null,"sources":["../src/D3Tip.js"],"sourcesContent":["const isFunc = monte.tools.isFunc;\nconst isNumeric = monte.tools.isNumeric;\nconst isObject = monte.tools.isObject;\n\nconst TIP_DEFAULTS = {\n  eventPrefix: 'd3tip',\n  css: 'd3-tip',\n  direction: 'n',\n  offset: {},\n  html: (d, i) => d.value || d || i,\n  featurePrefix: null,\n  showEvents: ['mouseover', 'touchstart'],\n  hideEvents: ['mouseout'],\n};\n\nexport class D3Tip extends monte.Extension {\n  _initOptions(...options) {\n    super._initOptions(...options, TIP_DEFAULTS);\n\n    // Throw option error if `featurePrefix` is left blank\n    if (!this.opts.featurePrefix) {\n      throw monte.MonteOptionError.RequiredOption('featurePrefix');\n    }\n  }\n\n  _render() {\n    const featurePrefix = this.tryInvoke(this.option('featurePrefix'));\n    const css = this.tryInvoke(this.option('css'));\n    const dir = this.tryInvoke(this.option('direction'));\n    const html = this.option('html'); // Should always be a function.\n    const offset = this.tryInvoke(this.option('offset'));\n    const showEvents = this.tryInvoke(this.option('showEvents'));\n    const hideEvents = this.tryInvoke(this.option('hideEvents'));\n    const tip = d3.tip().attr('class', css)\n      .direction(dir)\n      .html(html);\n\n    if (!isFunc(html)) {\n      throw new monte.MonteOptionError(`Check the \"html\" option value. A function is expected. Received: ${html}`);\n    }\n\n    if (isObject(offset)) {\n      tip.offset([\n        +offset.y || +offset.top || 0,\n        +offset.x || +offset.left || 0,\n      ]);\n    }\n    else if (isNumeric(offset)) {\n      // If a single number is provided assume that only a vertical shift is intended.\n      tip.offset([+offset, 0]);\n    }\n    else {\n      throw new monte.MonteOptionError(`Check the \"offset\" option value. A function, object, or number is expected. Received: ${offset}`);\n    }\n\n    this.chart.bound.call(tip);\n\n    showEvents.forEach((ev) => this.chart.on(`${featurePrefix}:${ev}`, tip.show));\n    hideEvents.forEach((ev) => this.chart.on(`${featurePrefix}:${ev}`, tip.hide));\n\n    this.tip = tip;\n  }\n\n  // Implemented to indicate that this extension intentionally does not respond to `updated` events.\n  _update() {}\n\n  _destroy() {\n    this.tip.destroy();\n  }\n}\n"],"names":["isFunc","monte","tools","isNumeric","isObject","TIP_DEFAULTS","d","i","value","D3Tip","options","opts","featurePrefix","MonteOptionError","RequiredOption","tryInvoke","option","css","dir","html","offset","showEvents","hideEvents","tip","d3","attr","direction","y","top","x","left","chart","bound","call","forEach","ev","on","show","hide","destroy","Extension"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAASC,MAAMC,KAAN,CAAYF,MAA3B;AACA,IAAMG,YAAYF,MAAMC,KAAN,CAAYC,SAA9B;AACA,IAAMC,WAAWH,MAAMC,KAAN,CAAYE,QAA7B;;AAEA,IAAMC,eAAe;eACN,OADM;OAEd,QAFc;aAGR,GAHQ;UAIX,EAJW;QAKb,cAACC,CAAD,EAAIC,CAAJ;WAAUD,EAAEE,KAAF,IAAWF,CAAX,IAAgBC,CAA1B;GALa;iBAMJ,IANI;cAOP,CAAC,WAAD,EAAc,YAAd,CAPO;cAQP,CAAC,UAAD;CARd;;AAWA,IAAaE,KAAb;;;;;;;;;;mCAC2B;;;wCAATC,OAAS;eAAA;;;uKACDA,OAAtB,GAA+BL,YAA/B;;;UAGI,CAAC,KAAKM,IAAL,CAAUC,aAAf,EAA8B;cACtBX,MAAMY,gBAAN,CAAuBC,cAAvB,CAAsC,eAAtC,CAAN;;;;;8BAIM;;;UACFF,gBAAgB,KAAKG,SAAL,CAAe,KAAKC,MAAL,CAAY,eAAZ,CAAf,CAAtB;UACMC,MAAM,KAAKF,SAAL,CAAe,KAAKC,MAAL,CAAY,KAAZ,CAAf,CAAZ;UACME,MAAM,KAAKH,SAAL,CAAe,KAAKC,MAAL,CAAY,WAAZ,CAAf,CAAZ;UACMG,OAAO,KAAKH,MAAL,CAAY,MAAZ,CAAb,CAJQ;UAKFI,SAAS,KAAKL,SAAL,CAAe,KAAKC,MAAL,CAAY,QAAZ,CAAf,CAAf;UACMK,aAAa,KAAKN,SAAL,CAAe,KAAKC,MAAL,CAAY,YAAZ,CAAf,CAAnB;UACMM,aAAa,KAAKP,SAAL,CAAe,KAAKC,MAAL,CAAY,YAAZ,CAAf,CAAnB;UACMO,MAAMC,GAAGD,GAAH,GAASE,IAAT,CAAc,OAAd,EAAuBR,GAAvB,EACTS,SADS,CACCR,GADD,EAETC,IAFS,CAEJA,IAFI,CAAZ;;UAII,CAACnB,OAAOmB,IAAP,CAAL,EAAmB;cACX,IAAIlB,MAAMY,gBAAV,uEAA+FM,IAA/F,CAAN;;;UAGEf,SAASgB,MAAT,CAAJ,EAAsB;YAChBA,MAAJ,CAAW,CACT,CAACA,OAAOO,CAAR,IAAa,CAACP,OAAOQ,GAArB,IAA4B,CADnB,EAET,CAACR,OAAOS,CAAR,IAAa,CAACT,OAAOU,IAArB,IAA6B,CAFpB,CAAX;OADF,MAMK,IAAI3B,UAAUiB,MAAV,CAAJ,EAAuB;;YAEtBA,MAAJ,CAAW,CAAC,CAACA,MAAF,EAAU,CAAV,CAAX;OAFG,MAIA;cACG,IAAInB,MAAMY,gBAAV,4FAAoHO,MAApH,CAAN;;;WAGGW,KAAL,CAAWC,KAAX,CAAiBC,IAAjB,CAAsBV,GAAtB;;iBAEWW,OAAX,CAAmB,UAACC,EAAD;eAAQ,OAAKJ,KAAL,CAAWK,EAAX,CAAiBxB,aAAjB,SAAkCuB,EAAlC,EAAwCZ,IAAIc,IAA5C,CAAR;OAAnB;iBACWH,OAAX,CAAmB,UAACC,EAAD;eAAQ,OAAKJ,KAAL,CAAWK,EAAX,CAAiBxB,aAAjB,SAAkCuB,EAAlC,EAAwCZ,IAAIe,IAA5C,CAAR;OAAnB;;WAEKf,GAAL,GAAWA,GAAX;;;;;;;8BAIQ;;;+BAEC;WACJA,GAAL,CAASgB,OAAT;;;;EApDuBtC,MAAMuC,SAAjC;;;;;;"}