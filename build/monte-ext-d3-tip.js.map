{"version":3,"file":null,"sources":["../src/D3Tip.js"],"sourcesContent":["const { isFunc, isNumeric, isObject, isArray } = monte.tools;\n\nconst TIP_DEFAULTS = {\n  eventPrefix: 'd3tip',\n  css: 'd3-tip',\n  direction: 'n',\n  offset: {},\n  html: (d, i) => d.value || d || i,\n  featurePrefix: '',\n  featureShowBindings: ['mouseover', 'touchstart'],\n  featureHideBindings: ['mouseout'],\n  showBindings: [],\n  hideBindings: [],\n};\n\nexport class D3Tip extends monte.Extension {\n  _initOptions(...options) {\n    super._initOptions(...options, TIP_DEFAULTS);\n\n    // Throw option error if `featurePrefix` is left blank\n    if (!this.opts.featurePrefix) {\n      throw monte.MonteOptionError.RequiredOption('featurePrefix', 'If you wish to listen directly to chart events use: \"chart\"');\n    }\n  }\n\n  _render() {\n    const css = this.tryInvoke(this.option('css'));\n    const dir = this.tryInvoke(this.option('direction'));\n    const html = this.option('html'); // Should always be a function.\n    const offset = this.tryInvoke(this.option('offset'));\n    const tip = d3.tip().attr('class', css)\n      .direction(dir)\n      .html(html);\n\n    if (!isFunc(html)) {\n      throw new monte.MonteOptionError(`Check the \"html\" option value. A function is expected. Received: ${html}`);\n    }\n\n    if (isObject(offset)) {\n      tip.offset([\n        +offset.y || +offset.top || 0,\n        +offset.x || +offset.left || 0,\n      ]);\n    }\n    else if (isNumeric(offset)) {\n      // If a single number is provided assume that only a vertical shift is intended.\n      tip.offset([+offset, 0]);\n    }\n    else {\n      throw new monte.MonteOptionError(`Check the \"offset\" option value. A function, object, or number is expected. Received: ${offset}`);\n    }\n\n    // Create D3 Tip instance and associate with chart.\n    this.chart.bound.call(tip);\n\n    this.tip = tip;\n    this._bindTipEvents();\n  }\n\n  _bindTipEvents() {\n    const tip = this.tip;\n    const featureShowBindings = this.tryInvoke(this.option('featureShowBindings'));\n    const featureHideBindings = this.tryInvoke(this.option('featureHideBindings'));\n    const showBindings = this.tryInvoke(this.option('showBindings'));\n    const hideBindings = this.tryInvoke(this.option('hideBindings'));\n\n    let featurePrefix = this.tryInvoke(this.option('featurePrefix'));\n    if (!isArray(featurePrefix)) { featurePrefix = [featurePrefix]; }\n\n    featurePrefix.forEach((fp) => {\n      featureShowBindings.forEach((ev) => this.chart.on(eventName(fp, ev), tip.show));\n      featureHideBindings.forEach((ev) => this.chart.on(eventName(fp, ev), tip.hide));\n    });\n\n    showBindings.forEach((ev) => this.chart.on(ev, tip.show));\n    hideBindings.forEach((ev) => this.chart.on(ev, tip.hide));\n  }\n\n  // Implemented to indicate that this extension intentionally does not respond to `updated` events.\n  // D3 Tip handles it's own show and hide events and renders itself.\n  _update() {}\n\n  _destroy() {\n    this.tip.destroy();\n  }\n\n  showTip(data, target) {\n    this.tip.show(data, target);\n  }\n\n  hideTip() {\n    this.tip.hide();\n  }\n}\n\nfunction eventName(featurePrefix, ev) {\n  return monte.Extension.featureEventName(featurePrefix, ev);\n}\n"],"names":["monte","tools","isFunc","isNumeric","isObject","isArray","TIP_DEFAULTS","d","i","value","D3Tip","options","opts","featurePrefix","MonteOptionError","RequiredOption","css","tryInvoke","option","dir","html","offset","tip","d3","attr","direction","y","top","x","left","chart","bound","call","_bindTipEvents","featureShowBindings","featureHideBindings","showBindings","hideBindings","forEach","fp","ev","on","eventName","show","hide","destroy","data","target","Extension","featureEventName"],"mappings":"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"}